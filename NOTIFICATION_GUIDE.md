# 通知功能使用指南

## 📢 功能概述

TG-EDU系统已集成完善的通知功能，实现了类似微信的实时通知体验。

## ✨ 功能特性

### 1. 通知入口
- **导航栏铃铛图标**：位于顶部导航栏"TG作业系统"右侧
- **未读消息提示**：红色徽章显示未读通知数量
- **下拉预览**：点击铃铛可预览最近3条未读通知
- **侧边栏入口**：左侧菜单栏的"通知中心"板块

### 2. 通知类型

#### 系统通知 (system)
- 由超级管理员或教师发送的系统公告
- 图标：蓝色信息图标 📘

#### 作业通知 (assignment)
- 作业相关的提醒通知
- 图标：蓝色任务图标 📋

#### 评分通知 (grade)
- 作业批改和评分通知（自动发送）
- 图标：黄色星星图标 ⭐
- **自动触发**：教师批改作业后自动通知学生

#### 公告通知 (announcement)
- 重要公告通知
- 图标：蓝色公告图标 📣

### 3. 权限说明

#### 超级管理员
可以发送通知给：
- ✅ 所有用户
- ✅ 指定角色（教师/学生）
- ✅ 指定个人

#### 教师
可以发送通知给：
- ✅ 自己管理的班级学生
- ❌ 无法向其他教师或全体用户发送

#### 学生
- ❌ 无法主动发送通知
- ✅ 可以接收通知
- ✅ 自动接收作业批改通知

## 📝 使用方法

### 发送通知（教师/管理员）

1. **进入发送页面**
   - 点击左侧菜单"通知中心" → "发送通知"
   - 或点击导航栏铃铛 → "查看所有通知" → "发送通知"

2. **填写通知内容**
   - **通知标题**：简洁明了的标题（必填，最多200字）
   - **通知内容**：详细的通知内容（必填，支持多行）
   - **通知类型**：选择系统通知/作业通知/公告通知

3. **选择接收对象**
   
   **超级管理员**：
   - 所有用户：发送给全体用户
   - 指定角色：只发送给教师或学生
   - 指定个人：从下拉列表选择具体用户
   
   **教师**：
   - 选择班级：从自己管理的班级中选择

4. **发送通知**
   - 点击"发送通知"按钮
   - 系统显示发送成功及接收人数

### 查看通知

1. **导航栏快速预览**
   - 点击铃铛图标查看最近3条未读通知
   - 红色徽章显示未读数量
   - 点击"查看所有通知"进入通知中心

2. **通知中心**
   - **全部通知**：查看所有收到的通知
   - **未读通知**：只显示未读通知
   - 通知按时间倒序排列（最新在前）

3. **通知详情**
   - 标题和内容完整显示
   - 发送者姓名
   - 发送时间（北京时间）
   - 相关作业链接（如有）

### 管理通知

1. **标记已读**
   - 单条标记：点击"标记已读"按钮
   - 全部标记：点击"全部标记为已读"按钮
   - 已读通知背景变白，无"新"标签

2. **删除通知**
   - 点击通知右侧的垃圾桶图标
   - 确认后删除（不可恢复）

3. **查看作业详情**
   - 对于评分通知，点击"查看作业详情"
   - 直接跳转到对应的作业提交历史页面

## 🔔 自动通知场景

系统会在以下情况自动发送通知：

### 作业批改通知
**触发时机**：教师给学生作业评分后

**通知内容**：
- 标题：`作业「XXX」已被批改`
- 内容：教师姓名、评分、评语（前100字）
- 类型：评分通知 ⭐

**接收对象**：被评分的学生

**示例**：
```
作业「Python基础练习」已被批改
教师 张老师 已对您的作业进行了评分，得分：95分

评语：代码规范，逻辑清晰，注释详细。建议优化算法复杂度...
```

## 💡 最佳实践

### 发送通知建议

1. **标题明确**
   - ✅ "紧急：明天停课通知"
   - ❌ "通知"

2. **内容清晰**
   - 说明具体事项
   - 包含时间、地点等关键信息
   - 如有需要，说明截止时间

3. **合理分类**
   - 系统维护 → 系统通知
   - 作业相关 → 作业通知
   - 重要事项 → 公告通知

4. **精准投放**
   - 只发给相关人员
   - 避免信息过载

### 查看通知建议

1. **及时查看**
   - 看到红色徽章及时查看
   - 避免错过重要信息

2. **定期清理**
   - 已读通知可以删除
   - 保持通知列表整洁

3. **关注评分通知**
   - 及时查看作业反馈
   - 了解学习情况

## 🎨 界面说明

### 通知徽章颜色
- 🔴 **红色**：未读通知
- ⚪ **白色背景**：已读通知

### 通知类型图标
- 📘 **蓝色信息图标**：系统通知
- 📋 **蓝色任务图标**：作业通知
- ⭐ **黄色星星**：评分通知
- 📣 **蓝色公告**：重要公告

### 操作按钮
- ✅ **绿色按钮**：标记已读
- 🗑️ **红色图标**：删除通知
- 👁️ **蓝色按钮**：查看详情

## 📊 技术说明

### 数据存储
- 通知存储在数据库 `notification` 表
- 支持大量历史通知
- 分页显示（每页20条）

### 实时更新
- 页面加载时获取最新未读数量
- 标记已读后立即更新徽章
- 删除通知后自动刷新列表

### 性能优化
- 只加载最近通知（分页）
- 下拉预览只显示3条
- 数据库索引优化查询速度

## ❓ 常见问题

### Q1: 为什么我发不出通知？
**A**: 检查以下几点：
- 是否有教师或管理员权限
- 教师需要先创建并分配班级
- 确保选择了接收对象

### Q2: 通知能撤回吗？
**A**: 已发送的通知无法撤回，但接收者可以删除

### Q3: 通知会保存多久？
**A**: 通知永久保存，除非用户手动删除

### Q4: 学生能发通知吗？
**A**: 目前学生只能接收通知，不能主动发送

### Q5: 批改作业会自动通知吗？
**A**: 是的，教师批改作业后会自动通知学生

### Q6: 如何批量通知所有学生？
**A**: 
- 超级管理员：选择"指定角色" → "学生"
- 教师：选择自己的班级

### Q7: 未读通知数量不准确？
**A**: 刷新页面即可更新，或点击"全部标记为已读"

## 📞 技术支持

如遇问题，请联系：
- GitHub: https://github.com/NUDTTAN91
- CSDN博客: https://blog.csdn.net/ZXW_NUDT

---

**版本**: v1.0  
**更新时间**: 2025-10-18  
**作者**: tan91
